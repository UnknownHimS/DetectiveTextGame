<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Detective Text Adventure - With Music</title>
  <link rel="icon" type="image/png" href="https://favicon.io/emoji-favicons/magnifying-glass/favicon-32x32.png" sizes="32x32" />
  <style>
    body {
      background: #222;
      color: #eee;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      max-width: 700px;
      margin: 40px auto;
      padding: 20px;
      border-radius: 10px;
      background-color: #222;
      box-shadow: 0 0 15px #000;
      transition: background 1s ease;
      background-repeat: no-repeat;
      background-position: center center;
      background-size: cover;
      position: relative;
    }
    #dialogue {
      white-space: pre-line;
      min-height: 140px;
      margin-bottom: 20px;
      font-size: 1.1rem;
      line-height: 1.5;
      background-color: rgba(0,0,0,0.5);
      padding: 15px;
      border-radius: 8px;
      box-shadow: inset 0 0 10px #000;
    }
    #choices button {
      margin-right: 10px;
      margin-top: 5px;
      padding: 10px 18px;
      font-size: 1rem;
      cursor: pointer;
      border-radius: 5px;
      border: none;
      background-color: #444;
      color: #eee;
      transition: background-color 0.3s;
    }
    #choices button:hover {
      background-color: #666;
    }
    #musicControl {
      position: fixed;
      top: 20px;
      right: 20px;
      background: rgba(0,0,0,0.6);
      border: none;
      color: #eee;
      padding: 10px 15px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      user-select: none;
      z-index: 1000;
    }
  </style>
</head>
<body>
  <button id="musicControl">ðŸ”ˆ Mute Music</button>
  <div id="dialogue"></div>
  <div id="choices"></div>
  <audio id="bgMusic" loop>
   <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg" />
    Your browser does not support the audio element.
  </audio>

  <script>
    const musicControl = document.getElementById('musicControl');
    const bgMusic = document.getElementById('bgMusic');

    // Try to play music after user interaction (some browsers require this)
    function tryPlayMusic() {
      bgMusic.play().catch(() => {
        // Autoplay blocked
      });
    }

    musicControl.addEventListener('click', () => {
      if (bgMusic.paused) {
        bgMusic.play();
        musicControl.textContent = 'ðŸ”ˆ Mute Music';
      } else {
        bgMusic.pause();
        musicControl.textContent = 'ðŸ”‡ Play Music';
      }
    });

    // Start music on first user interaction to avoid autoplay block
    document.body.addEventListener('click', tryPlayMusic, { once: true });

    // Your existing game code below
    const gameState = {
      clues: [],
      currentScene: 'intro',
      accused: null,
      suspects: ['Mr. Green', 'Ms. Violet', 'Colonel Mustard', 'Mrs. Peacock'],
      interrogations: {
        'Mr. Green': false,
        'Ms. Violet': false,
        'Colonel Mustard': false,
        'Mrs. Peacock': false
      }
    };

    const scenes = {
      intro: {
        background: '#1e1e2f',
        dialogues: [
          "Partner: Detective, we've got a fresh case at the old mansion.",
          "Partner: The victim was found dead in the library, no forced entry.",
          "Partner: Where should we start?"
        ],
        choices: [
          { text: "Review the case file", nextScene: "caseFile" },
          { text: "Go to the mansion", nextScene: "mansionArrival" }
        ]
      },
      caseFile: {
        background: '#2d2d3d',
        dialogues: [
          "Partner: Victim had meetings with 4 suspects earlier today.",
          "Partner: Suspects are Mr. Green, Ms. Violet, Colonel Mustard, and Mrs. Peacock.",
          "Partner: Each one has a possible motive.",
          "Partner: Ready to head to the mansion?"
        ],
        choices: [
          { text: "Go to the mansion", nextScene: "mansionArrival" },
          { text: "Ask about suspects", nextScene: "suspectInfo" }
        ]
      },
      suspectInfo: {
        background: '#2d2d3d',
        dialogues: [
          "Partner: Mr. Green is the business partner; they had financial disputes.",
          "Partner: Ms. Violet is a former lover, they had a recent fight.",
          "Partner: Colonel Mustard is a rival collector, jealous of the victim.",
          "Partner: Mrs. Peacock is the housekeeper, knows everyone's secrets.",
          "Partner: Anything else you want to do before the mansion?"
        ],
        choices: [
          { text: "Go to the mansion", nextScene: "mansionArrival" },
          { text: "Review the case file again", nextScene: "caseFile" }
        ]
      },
      mansionArrival: {
        background: 'url("https://images.unsplash.com/photo-1679683171686-6242c0fde282?q=80&w=870&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D")',
        dialogues: [
          "You arrive at the mansion. The eerie silence is unsettling.",
          "Partner: Where should we start?"
        ],
        choices: [
          { text: "Inspect the library", nextScene: "library" },
          { text: "Talk to the butler", nextScene: "butler" },
          { text: "Talk to Mrs. Peacock (housekeeper)", nextScene: "mrsPeacock" },
          { text: "Inspect the garden", nextScene: "garden" }
        ]
      },
      library: {
        background: 'url("https://media.istockphoto.com/id/579731340/photo/journalists-writers-desk.webp?a=1&s=612x612&w=0&k=20&c=CGz_Jt6q_frwKQSK70fLQ1LEkkGlCI-jWvuQ1bhJqwI=")',
        dialogues: [
          "You find a torn page from the victimâ€™s diary on the floor.",
          "Partner: Clue added: Torn Diary Page.",
          "Partner: Anything else?"
        ],
        clue: "Torn Diary Page",
        choices: [
          { text: "Look at the desk drawer", nextScene: "deskDrawer" },
          { text: "Go back to the mansion entrance", nextScene: "mansionArrival" }
        ]
      },
      deskDrawer: {
        background: 'url("https://i.pinimg.com/736x/57/20/4c/57204ce319da085fd84b917542c2c47e.jpg")',
        dialogues: [
          "You find a small locked box. It's locked tight.",
          "Partner: Maybe we can find a key elsewhere."
        ],
        choices: [
          { text: "Inspect the kitchen", nextScene: "kitchen" },
          { text: "Talk to the butler", nextScene: "butler" },
          { text: "Go back to library", nextScene: "library" }
        ]
      },
      kitchen: {
        background: 'url("https://i.pinimg.com/736x/26/a9/9b/26a99b54bf70e7dfcb71b10389386ffc.jpg")',
        dialogues: [
          "You find a bloody knife in the sink.",
          "Partner: Clue added: Bloody Knife.",
          "Partner: Look around or talk to someone?"
        ],
        clue: "Bloody Knife",
        choices: [
          { text: "Talk to Mrs. Peacock", nextScene: "mrsPeacock" },
          { text: "Inspect the garden", nextScene: "garden" },
          { text: "Go back to mansion entrance", nextScene: "mansionArrival" }
        ]
      },
      butler: {
        background: '#3a3a3a',
        dialogues: [
          "The butler seems nervous.",
          "Partner: Ask about his whereabouts during the murder."
        ],
        choices: [
          { text: "Ask about his whereabouts", nextScene: "butlerAlibi" },
          { text: "Ask if he saw anything suspicious", nextScene: "butlerSuspicious" },
          { text: "Return to mansion entrance", nextScene: "mansionArrival" }
        ]
      },
      butlerAlibi: {
        background: '#3a3a3a',
        dialogues: [
          "Butler: I was cleaning the garden at that time.",
          "Partner: Clue added: Butler's Alibi.",
          "Anything else?"
        ],
        clue: "Butler's Alibi",
        choices: [
          { text: "Ask if he saw anything suspicious", nextScene: "butlerSuspicious" },
          { text: "Return to mansion entrance", nextScene: "mansionArrival" }
        ]
      },
      butlerSuspicious: {
        background: '#3a3a3a',
        dialogues: [
          "Butler: I saw Colonel Mustard acting nervously near the library earlier.",
          "Partner: Clue added: Colonel Mustard Nervous.",
          "Do you want to interrogate Colonel Mustard?"
        ],
        clue: "Colonel Mustard Nervous",
        choices: [
          { text: "Interrogate Colonel Mustard", nextScene: "interrogateMustard" },
          { text: "Return to mansion entrance", nextScene: "mansionArrival" }
        ]
      },
      mrsPeacock: {
        background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=800&q=80")',
        dialogues: [
          "Mrs. Peacock: I was preparing dinner in the kitchen, saw nothing unusual.",
          "Partner: Do you want to interrogate Mrs. Peacock?"
        ],
        choices: [
          { text: "Interrogate Mrs. Peacock", nextScene: "interrogatePeacock" },
          { text: "Return to mansion entrance", nextScene: "mansionArrival" }
        ]
      },
      garden: {
        background: 'url("https://i.pinimg.com/1200x/ec/8a/41/ec8a41bb0e030bb1e361c734edfc3cb1.jpg")',
        dialogues: [
          "You find muddy footprints leading toward the shed.",
          "Partner: Clue added: Muddy Footprints.",
          "Want to check the shed?"
        ],
        clue: "Muddy Footprints",
        choices: [
          { text: "Check the shed", nextScene: "shed" },
          { text: "Return to mansion entrance", nextScene: "mansionArrival" }
        ]
      },
      shed: {
        background: 'url("https://ph.pinterest.com/pin/610800768251056674/")',
        dialogues: [
          "Inside the shed you find a broken watch with initials 'M.V.'",
          "Partner: Clue added: Broken Watch.",
          "Could this be Ms. Violet's? What next?"
        ],
        clue: "Broken Watch",
        choices: [
          { text: "Interrogate Ms. Violet", nextScene: "interrogateViolet" },
          { text: "Return to mansion entrance", nextScene: "mansionArrival" }
        ]
      },
      interrogateMustard: {
        background: '#3a3a3a',
        dialogues: [
          "Colonel Mustard: I was just checking some books, didn't kill anyone!",
          "Partner: Seems nervous. Let's see if we can press him."
        ],
        choices: [
          { text: "Press Colonel Mustard", nextScene: "pressMustard" },
          { text: "Return to mansion entrance", nextScene: "mansionArrival" }
        ]
      },
      pressMustard: {
        background: '#3a3a3a',
        dialogues: [
          "Colonel Mustard: Fine! I admit, I argued with the victim about a rare book!",
          "Partner: Clue added: Mustard Argument.",
          "What's next?"
        ],
        clue: "Mustard Argument",
        choices: [
          { text: "Accuse a suspect", nextScene: "accuse" },
          { text: "Return to mansion entrance", nextScene: "mansionArrival" }
        ]
      },
      interrogatePeacock: {
        background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=800&q=80")',
        dialogues: [
          "Mrs. Peacock: I was in the kitchen all night. You can ask the butler.",
          "Partner: Clue added: Peacock's Alibi.",
          "Want to press her?"
        ],
        clue: "Peacock's Alibi",
        choices: [
          { text: "Press Mrs. Peacock", nextScene: "pressPeacock" },
          { text: "Return to mansion entrance", nextScene: "mansionArrival" }
        ]
      },
      pressPeacock: {
        background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=800&q=80")',
        dialogues: [
          "Mrs. Peacock: I swear I know nothing! Please stop bothering me!",
          "Partner: Not much more from her.",
          "Where to next?"
        ],
        choices: [
          { text: "Accuse a suspect", nextScene: "accuse" },
          { text: "Return to mansion entrance", nextScene: "mansionArrival" }
        ]
      },
      interrogateViolet: {
        background: '#4a2c3b',
        dialogues: [
          "Ms. Violet: The victim was going to cut me off financially if I didnâ€™t leave town!",
          "Partner: Clue added: Violet threatened.",
          "Press her or go back?"
        ],
        clue: "Violet threatened",
        choices: [
          { text: "Press Violet", nextScene: "pressViolet" },
          { text: "Return to mansion entrance", nextScene: "mansionArrival" }
        ]
      },
      pressViolet: {
        background: '#4a2c3b',
        dialogues: [
          "Ms. Violet: Okay! I admit it! But I didn't kill him!",
          "Partner: You have to decide who to accuse."
        ],
        choices: [
          { text: "Accuse a suspect", nextScene: "accuse" },
          { text: "Return to mansion entrance", nextScene: "mansionArrival" }
        ]
      },
      accuse: {
        background: '#111',
        dialogues: [
          "Partner: Based on what we've gathered, who do you think the culprit is?"
        ],
        choices: [
          { text: "Mr. Green", nextScene: "accuseResult", suspect: "Mr. Green" },
          { text: "Ms. Violet", nextScene: "accuseResult", suspect: "Ms. Violet" },
          { text: "Colonel Mustard", nextScene: "accuseResult", suspect: "Colonel Mustard" },
          { text: "Mrs. Peacock", nextScene: "accuseResult", suspect: "Mrs. Peacock" }
        ]
      },
      accuseResult: {
        background: '#111',
        dialogues: [],
        choices: []
      },
       comedyIntro: {
        background: '#222',
        dialogues: [
          "Partner: Hey, you sound half asleep... Did the last case tire you out?",
          "You: Haha, yeah... that one was a real brain bender.",
          "Partner: Well, get ready! Iâ€™m starting the car.",
          "You: Wait, why do we even have cases again? Canâ€™t we take a day off?",
          "Partner: Ha! You can try running, but where do you think youâ€™ll go?",
          "You: ...Fine, letâ€™s go then."
        ],
        choices: [
          { text: "Start New Case", nextScene: "newCaseIntro" }
        ]
      },
    
      newCaseIntro: {
        background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=870&q=80")',
        dialogues: [
          "You arrive at the new crime scene â€” a bustling city alley with a twist.",
          "Partner: This oneâ€™s going to be tricky. Are you ready?"
        ],
        choices: [
          { text: "Start Investigation", nextScene: "alleyScene" }
        ]
      },
    
      alleyScene: {
        background: 'url("https://images.unsplash.com/photo-1501594907352-04cda38ebc29?auto=format&fit=crop&w=870&q=80")',
        dialogues: [
          "You look around the alley. Trash cans overturned, mysterious footprints.",
          "Partner: Looks like someone was in a hurry. What do you want to do?"
        ],
        choices: [
          { text: "Inspect footprints", nextScene: "footprints" },
          { text: "Check the trash cans", nextScene: "trashCans" },
          { text: "Talk to the nearby witness", nextScene: "witness" }
        ]
      },
    
      footprints: {
        background: 'url("https://images.unsplash.com/photo-1521412644187-c49fa049e84d?auto=format&fit=crop&w=870&q=80")',
        dialogues: [
          "The footprints seem fresh, leading towards the back entrance of a nearby building.",
          "Partner: Clue added: Fresh Footprints."
        ],
        clue: "Fresh Footprints",
        choices: [
          { text: "Follow footprints", nextScene: "backEntrance" },
          { text: "Go back", nextScene: "alleyScene" }
        ]
      },
    
      trashCans: {
        background: 'url("https://images.unsplash.com/photo-1472214103451-9374bd1c798e?auto=format&fit=crop&w=870&q=80")',
        dialogues: [
          "You rummage through the trash cans and find a torn piece of fabric.",
          "Partner: Clue added: Torn Fabric."
        ],
        clue: "Torn Fabric",
        choices: [
          { text: "Take fabric to analyze later", nextScene: "alleyScene" }
        ]
      },
    
      witness: {
        background: 'url("https://images.unsplash.com/photo-1508214751196-bcfd4ca60f91?auto=format&fit=crop&w=870&q=80")',
        dialogues: [
          "The witness nervously mentions seeing a shadowy figure running away.",
          "Partner: Clue added: Shadowy Figure Witnessed."
        ],
        clue: "Shadowy Figure Witnessed",
        choices: [
          { text: "Ask more questions", nextScene: "witnessQuestions" },
          { text: "Return to alley", nextScene: "alleyScene" }
        ]
      },
    
      witnessQuestions: {
        background: 'url("https://images.unsplash.com/photo-1508214751196-bcfd4ca60f91?auto=format&fit=crop&w=870&q=80")',
        dialogues: [
          "Witness: They were wearing a hoodie and moved really fast.",
          "Partner: Could be important. We need to find out who it was."
        ],
        choices: [
          { text: "Go check the back entrance", nextScene: "backEntrance" },
          { text: "Return to alley", nextScene: "alleyScene" }
        ]
      },
    
      backEntrance: {
        background: 'url("https://images.unsplash.com/photo-1526403226437-cfcdf5626899?auto=format&fit=crop&w=870&q=80")',
        dialogues: [
          "You arrive at the back entrance. The door is slightly ajar.",
          "Partner: Should we go in?"
        ],
        choices: [
          { text: "Enter the building", nextScene: "insideBuilding" },
          { text: "Go back", nextScene: "alleyScene" }
        ]
      },
    
      insideBuilding: {
        background: 'url("https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=870&q=80")',
        dialogues: [
          "Inside, you see overturned furniture and a broken vase.",
          "Partner: Looks like a struggle happened here. Clue added: Signs of Struggle."
        ],
        clue: "Signs of Struggle",
        choices: [
          { text: "Search the room", nextScene: "searchRoom" },
          { text: "Return outside", nextScene: "backEntrance" }
        ]
      },
    
      searchRoom: {
        background: 'url("https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=870&q=80")',
        dialogues: [
          "You find a hidden note under the table with a strange symbol.",
          "Partner: Clue added: Strange Symbol Note."
        ],
        clue: "Strange Symbol Note",
        choices: [
          { text: "Take note for analysis", nextScene: "insideBuilding" },
          { text: "Return outside", nextScene: "backEntrance" }
        ]
      },
    
      analyzeClues: {
        background: '#111',
        dialogues: [
          "You spread out your clues and start piecing things together.",
          "Partner: We have: Torn Fabric, Fresh Footprints, Shadowy Figure Witnessed, Signs of Struggle, and Strange Symbol Note.",
          "You: Something tells me these are connected."
        ],
        choices: [
          { text: "Go back to the alley", nextScene: "alleyScene" },
          { text: "Visit the lab to analyze fabric", nextScene: "labScene" },
          { text: "Head to local informant", nextScene: "informantScene" }
        ]
      },
    
      labScene: {
        background: 'url("https://images.unsplash.com/photo-1554475901-4538ddfbccc2?auto=format&fit=crop&w=870&q=80")',
        dialogues: [
          "At the lab, technicians examine the torn fabric under the microscope.",
          "Technician: This fabric matches a rare brand only sold in one store downtown."
        ],
        clue: "Rare Brand Fabric",
        choices: [
          { text: "Go visit the store", nextScene: "storeScene" },
          { text: "Return to analysis", nextScene: "analyzeClues" }
        ]
      },
    
      storeScene: {
        background: 'url("https://images.unsplash.com/photo-1508898578281-774ac4893a83?auto=format&fit=crop&w=870&q=80")',
        dialogues: [
          "The store owner recognizes the fabric and mentions a recent suspicious customer.",
          "Store Owner: He was wearing a hoodie, came in looking nervous."
        ],
        clue: "Hoodie Suspicious Customer",
        choices: [
          { text: "Ask about the customer's name", nextScene: "storeOwnerQuestions" },
          { text: "Return to analysis", nextScene: "analyzeClues" }
        ]
      },
    
      storeOwnerQuestions: {
        background: 'url("https://images.unsplash.com/photo-1508898578281-774ac4893a83?auto=format&fit=crop&w=870&q=80")',
        dialogues: [
          "Store Owner: Sorry, I didnâ€™t catch his name, but he paid in cash and left fast.",
          "Partner: Not much to go on. Let's keep digging."
        ],
        choices: [
          { text: "Return to analysis", nextScene: "analyzeClues" }
        ]
      },
    
      informantScene: {
        background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=870&q=80")',
        dialogues: [
          "Your informant greets you in a dimly lit bar.",
          "Informant: I heard whispers about a gang using strange symbols to mark territory.",
          "Partner: Could that be related to the strange symbol note?"
        ],
        clue: "Gang Symbol Connection",
        choices: [
          { text: "Ask about gang members", nextScene: "gangInfo" },
          { text: "Return to analysis", nextScene: "analyzeClues" }
        ]
      },
    
      gangInfo: {
        background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=870&q=80")',
        dialogues: [
          "Informant: The gangâ€™s leader is called 'The Hooded One'.",
          "Partner: Fits the hoodie clue. This is getting interesting."
        ],
        choices: [
          { text: "Look for 'The Hooded One'", nextScene: "hoodedOneScene" },
          { text: "Return to analysis", nextScene: "analyzeClues" }
        ]
      },
    
      hoodedOneScene: {
        background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=870&q=80")',
        dialogues: [
          "You track down a suspicious figure matching the description near the docks.",
          "Partner: There he is... The Hooded One."
        ],
        choices: [
          { text: "Confront him", nextScene: "confrontation" },
          { text: "Observe quietly", nextScene: "observe" }
        ]
      },
    
      confrontation: {
        background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=870&q=80")',
        dialogues: [
          "You confront the hooded figure. He pulls down his hood revealing... itâ€™s the store owner!",
          "Partner: What?! That canâ€™t be right."
        ],
        choices: [
          { text: "Accuse store owner", nextScene: "accuseStoreOwner" },
          { text: "Keep investigating", nextScene: "analyzeClues" }
        ]
      },
    
      accuseStoreOwner: {
        background: '#800000',
        dialogues: [
          "You accuse the store owner of being involved in the crime.",
          "Store Owner: I swear I didnâ€™t do anything! Itâ€™s not what it looks like!",
          "Partner: We need more proof."
        ],
        choices: [
          { text: "Return to analysis", nextScene: "analyzeClues" }
        ]
      },
    
      observe: {
        background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=870&q=80")',
        dialogues: [
          "You observe quietly and notice the hooded figure slipping something into a locker.",
          "Partner: Letâ€™s check that locker."
        ],
        choices: [
          { text: "Open locker", nextScene: "lockerScene" },
          { text: "Follow figure further", nextScene: "followFigure" }
        ]
      },
    
      lockerScene: {
        background: 'url("https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=870&q=80")',
        dialogues: [
          "Inside the locker, you find stolen goods and evidence linking the store owner to the crime.",
          "Partner: This is the proof we need!"
        ],
        clue: "Locker Evidence",
        choices: [
          { text: "Arrest store owner", nextScene: "caseSolved" },
          { text: "Keep investigating", nextScene: "analyzeClues" }
        ]
      },
    
      followFigure: {
        background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=870&q=80")',
        dialogues: [
          "You follow the hooded figure to an abandoned warehouse.",
          "Partner: Looks like the gang's hideout."
        ],
        choices: [
          { text: "Enter warehouse", nextScene: "warehouseScene" },
          { text: "Call for backup", nextScene: "callBackup" }
        ]
      },
    
      warehouseScene: {
        background: 'url("https://images.unsplash.com/photo-1518837695005-2083093ee35b?auto=format&fit=crop&w=870&q=80")',
        dialogues: [
          "Inside the warehouse, you find gang members counting stolen goods.",
          "Partner: We caught them red-handed!"
        ],
        choices: [
          { text: "Arrest gang members", nextScene: "caseSolved" },
          { text: "Try to gather more evidence", nextScene: "gatherEvidence" }
        ]
      },
    
      callBackup: {
        background: '#333',
        dialogues: [
          "You call for backup. Police reinforcements arrive quickly.",
          "Partner: Time to make the arrests!"
        ],
        choices: [
          { text: "Arrest gang members", nextScene: "caseSolved" }
        ]
      },
    
      gatherEvidence: {
        background: '#222',
        dialogues: [
          "You find a ledger listing all stolen items and gang members.",
          "Partner: This will make the case airtight."
        ],
        clue: "Gang Ledger",
        choices: [
          { text: "Take ledger and arrest", nextScene: "caseSolved" }
        ]
      },
    
      caseSolved: {
        background: '#004400',
        dialogues: [
          "The case is closed! The gang is behind bars and the mystery solved.",
          "Partner: Nice work, detective. Ready for the next case?"
        ],
        choices: [
          { text: "Restart Game", nextScene: "comedyIntro" }
        ]
      }
    };

    const dialogueElem = document.getElementById('dialogue');
    const choicesElem = document.getElementById('choices');

    let dialogueIndex = 0;

    function setBackground(bg) {
      if (bg.startsWith('url(')) {
        document.body.style.backgroundImage = bg;
        document.body.style.backgroundColor = '';
      } else {
        document.body.style.backgroundImage = '';
        document.body.style.backgroundColor = bg;
      }
    }

    function addClue(clue) {
      if (clue && !gameState.clues.includes(clue)) {
        gameState.clues.push(clue);
      }
    }

    function showScene(sceneKey) {
      const scene = scenes[sceneKey];
      if (!scene) return;

      gameState.currentScene = sceneKey;
      dialogueIndex = 0;
      setBackground(scene.background);

      if (scene.clue) {
        addClue(scene.clue);
      }

      renderDialogue(scene);
      renderChoices(scene);
    }

    function renderDialogue(scene) {
      if (dialogueIndex < scene.dialogues.length) {
        dialogueElem.textContent = scene.dialogues[dialogueIndex];
      } else {
        dialogueElem.textContent = "";
      }
    }

    function renderChoices(scene) {
      choicesElem.innerHTML = "";
      scene.choices.forEach(choice => {
        const btn = document.createElement('button');
        btn.textContent = choice.text;
        btn.onclick = () => {
          if (choice.nextScene === 'accuseResult') {
            gameState.accused = choice.suspect;
            showAccuseResult(choice.suspect);
          } else {
            showScene(choice.nextScene);
          }
        };
        choicesElem.appendChild(btn);
      });
    }

    function showAccuseResult(suspect) {
      dialogueIndex = 0;
      const resultElem = dialogueElem;
      const choicesElemLocal = choicesElem;
      setBackground('#111');

      // Determine if accusation is correct (let's say Colonel Mustard is culprit for example)
      const culprit = 'Colonel Mustard';

      if (suspect === culprit) {
        resultElem.textContent = `You accused ${suspect}. Congratulations! You solved the case! It was indeed ${culprit}.`;
      } else {
        resultElem.textContent = `You accused ${suspect}. Unfortunately, that is incorrect. The real culprit was ${culprit}.`;
      }

      choicesElemLocal.innerHTML = '';

      const restartBtn = document.createElement('button');
      restartBtn.textContent = 'Play Again';
      restartBtn.onclick = () => {
        gameState.clues = [];
        gameState.accused = null;
        showScene('intro');
      };
      choicesElemLocal.appendChild(restartBtn);
    }

    // Add clicking to advance dialogue in scenes with multiple dialogues
    dialogueElem.addEventListener('click', () => {
      const scene = scenes[gameState.currentScene];
      if (!scene) return;

      if (dialogueIndex < scene.dialogues.length - 1) {
        dialogueIndex++;
        renderDialogue(scene);
      }
    });

    // Start game
    showScene('intro');
  </script>
</body>
</html>
