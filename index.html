<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Detective Text Adventure - With Music</title>
  <link rel="icon" type="image/jpg" sizes="16x16" href="https://i.pinimg.com/1200x/44/62/be/4462be16cf026dbcd97b0ff2e10bbce9.jpg">
  <style>
    body {
    background: #222;
    color: #eee;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    max-width: 700px;
    margin: 40px auto;
    padding: 20px;
    border-radius: 10px;
    background-color: #222;
    box-shadow: 0 0 15px #000;
    transition: background 1s ease;
    background-repeat: no-repeat;
    background-position: center center;
    background-size: cover;
    position: relative;
    /* Add smooth font scaling on smaller devices */
    font-size: 16px; 
  }
  
  /* Dialogue box */
  #dialogue {
    white-space: pre-line;
    min-height: 140px;
    margin-bottom: 20px;
    font-size: 1.1rem;
    line-height: 1.5;
    background-color: rgba(0, 0, 0, 0.5);
    padding: 15px;
    border-radius: 8px;
    box-shadow: inset 0 0 10px #000;
    /* Make sure text doesn't overflow */
    word-wrap: break-word;
  }
  
  /* Choice buttons */
  #choices button {
    margin: 5px 10px 5px 0;
    padding: 12px 18px;
    font-size: 1rem;
    cursor: pointer;
    border-radius: 5px;
    border: none;
    background-color: #444;
    color: #eee;
    transition: background-color 0.3s;
    min-width: 120px;
    /* Make buttons easier to tap on mobile */
    touch-action: manipulation;
    user-select: none;
  }
  
  #choices button:hover,
  #choices button:focus {
    background-color: #666;
    outline: none;
  }
  
  /* Music control button */
  #musicControl {
    position: fixed;
    top: 20px;
    right: 20px;
    background: rgba(0, 0, 0, 0.6);
    border: none;
    color: #eee;
    padding: 10px 15px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1rem;
    user-select: none;
    z-index: 1000;
  }
  
  /* Responsive adjustments for smaller screens */
  @media (max-width: 480px) {
    body {
      margin: 20px 10px;
      padding: 15px;
      max-width: 100%;
      font-size: 14px;
      border-radius: 0;
    }
  
    #dialogue {
      min-height: 120px;
      font-size: 1rem;
      padding: 12px;
    }
  
    #choices button {
      font-size: 0.9rem;
      padding: 10px 12px;
      min-width: 100%;
      margin: 6px 0;
      display: block;
    }
  
    #musicControl {
      top: 10px;
      right: 10px;
      padding: 8px 12px;
      font-size: 0.9rem;
    }
  }

  </style>
</head>
<body>
  <button id="musicControl">ðŸ”ˆ Mute Music</button>
  <div id="dialogue"></div>
  <div id="choices"></div>
  <audio id="bgMusic" loop>
   <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-13.mp3" type="audio/mpeg" />
    Your browser does not support the audio element.
  </audio>

  <script>
    const musicControl = document.getElementById('musicControl');
    const bgMusic = document.getElementById('bgMusic');

    // Try to play music after user interaction (some browsers require this)
    function tryPlayMusic() {
      bgMusic.play().catch(() => {
        // Autoplay blocked
      });
    }

    musicControl.addEventListener('click', () => {
      if (bgMusic.paused) {
        bgMusic.play();
        musicControl.textContent = 'ðŸ”ˆ Mute Music';
      } else {
        bgMusic.pause();
        musicControl.textContent = 'ðŸ”‡ Play Music';
      }
    });

    // Start music on first user interaction to avoid autoplay block
    document.body.addEventListener('click', tryPlayMusic, { once: true });

    // Your existing game code below
    const gameState = {
      clues: [],
      currentScene: 'intro',
      accused: null,
      suspects: ['Mr. Green', 'Ms. Violet', 'Colonel Mustard', 'Mrs. Peacock'],
      interrogations: {
        'Mr. Green': false,
        'Ms. Violet': false,
        'Colonel Mustard': false,
        'Mrs. Peacock': false
      }
    };

    const scenes = {
      intro: {
        background: '#1e1e2f',
        dialogues: [
          "Partner: Detective, we've got a fresh case at the old mansion.",
          "Partner: The victim was found dead in the library, no forced entry.",
          "Partner: Where should we start?"
        ],
        choices: [
          { text: "Review the case file", nextScene: "caseFile" },
          { text: "Go to the mansion", nextScene: "mansionArrival" }
        ]
      },
      caseFile: {
        background: '#2d2d3d',
        dialogues: [
          "Partner: Victim had meetings with 4 suspects earlier today.",
          "Partner: Suspects are Mr. Green, Ms. Violet, Colonel Mustard, and Mrs. Peacock.",
          "Partner: Each one has a possible motive.",
          "Partner: Ready to head to the mansion?"
        ],
        choices: [
          { text: "Go to the mansion", nextScene: "mansionArrival" },
          { text: "Ask about suspects", nextScene: "suspectInfo" }
        ]
      },
      suspectInfo: {
        background: '#2d2d3d',
        dialogues: [
          "Partner: Mr. Green is the business partner; they had financial disputes.",
          "Partner: Ms. Violet is a former lover, they had a recent fight.",
          "Partner: Colonel Mustard is a rival collector, jealous of the victim.",
          "Partner: Mrs. Peacock is the housekeeper, knows everyone's secrets.",
          "Partner: Anything else you want to do before the mansion?"
        ],
        choices: [
          { text: "Go to the mansion", nextScene: "mansionArrival" },
          { text: "Review the case file again", nextScene: "caseFile" }
        ]
      },
      mansionArrival: {
        background: 'url("https://images.unsplash.com/photo-1679683171686-6242c0fde282?q=80&w=870&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D")',
        dialogues: [
          "You arrive at the mansion. The eerie silence is unsettling.",
          "Partner: Where should we start?"
        ],
        choices: [
          { text: "Inspect the library", nextScene: "library" },
          { text: "Talk to the butler", nextScene: "butler" },
          { text: "Talk to Mrs. Peacock (housekeeper)", nextScene: "mrsPeacock" },
          { text: "Inspect the garden", nextScene: "garden" }
        ]
      },
      library: {
        background: 'url("https://media.istockphoto.com/id/579731340/photo/journalists-writers-desk.webp?a=1&s=612x612&w=0&k=20&c=CGz_Jt6q_frwKQSK70fLQ1LEkkGlCI-jWvuQ1bhJqwI=")',
        dialogues: [
          "You find a torn page from the victimâ€™s diary on the floor.",
          "Partner: Clue added: Torn Diary Page.",
          "Partner: Anything else?"
        ],
        clue: "Torn Diary Page",
        choices: [
          { text: "Look at the desk drawer", nextScene: "deskDrawer" },
          { text: "Go back to the mansion entrance", nextScene: "mansionArrival" }
        ]
      },
      deskDrawer: {
        background: 'url("https://i.pinimg.com/736x/57/20/4c/57204ce319da085fd84b917542c2c47e.jpg")',
        dialogues: [
          "You find a small locked box. It's locked tight.",
          "Partner: Maybe we can find a key elsewhere."
        ],
        choices: [
          { text: "Inspect the kitchen", nextScene: "kitchen" },
          { text: "Talk to the butler", nextScene: "butler" },
          { text: "Go back to library", nextScene: "library" }
        ]
      },
      kitchen: {
        background: 'url("https://i.pinimg.com/736x/26/a9/9b/26a99b54bf70e7dfcb71b10389386ffc.jpg")',
        dialogues: [
          "You find a bloody knife in the sink.",
          "Partner: Clue added: Bloody Knife.",
          "Partner: Look around or talk to someone?"
        ],
        clue: "Bloody Knife",
        choices: [
          { text: "Talk to Mrs. Peacock", nextScene: "mrsPeacock" },
          { text: "Inspect the garden", nextScene: "garden" },
          { text: "Go back to mansion entrance", nextScene: "mansionArrival" }
        ]
      },
      butler: {
        background: '#3a3a3a',
        dialogues: [
          "The butler seems nervous.",
          "Partner: Ask about his whereabouts during the murder."
        ],
        choices: [
          { text: "Ask about his whereabouts", nextScene: "butlerAlibi" },
          { text: "Ask if he saw anything suspicious", nextScene: "butlerSuspicious" },
          { text: "Return to mansion entrance", nextScene: "mansionArrival" }
        ]
      },
      butlerAlibi: {
        background: '#3a3a3a',
        dialogues: [
          "Butler: I was cleaning the garden at that time.",
          "Partner: Clue added: Butler's Alibi.",
          "Anything else?"
        ],
        clue: "Butler's Alibi",
        choices: [
          { text: "Ask if he saw anything suspicious", nextScene: "butlerSuspicious" },
          { text: "Return to mansion entrance", nextScene: "mansionArrival" }
        ]
      },
      butlerSuspicious: {
        background: '#3a3a3a',
        dialogues: [
          "Butler: I saw Colonel Mustard acting nervously near the library earlier.",
          "Partner: Clue added: Colonel Mustard Nervous.",
          "Do you want to interrogate Colonel Mustard?"
        ],
        clue: "Colonel Mustard Nervous",
        choices: [
          { text: "Interrogate Colonel Mustard", nextScene: "interrogateMustard" },
          { text: "Return to mansion entrance", nextScene: "mansionArrival" }
        ]
      },
      mrsPeacock: {
        background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=800&q=80")',
        dialogues: [
          "Mrs. Peacock: I was preparing dinner in the kitchen, saw nothing unusual.",
          "Partner: Do you want to interrogate Mrs. Peacock?"
        ],
        choices: [
          { text: "Interrogate Mrs. Peacock", nextScene: "interrogatePeacock" },
          { text: "Return to mansion entrance", nextScene: "mansionArrival" }
        ]
      },
      garden: {
        background: 'url("https://i.pinimg.com/1200x/ec/8a/41/ec8a41bb0e030bb1e361c734edfc3cb1.jpg")',
        dialogues: [
          "You find muddy footprints leading toward the shed.",
          "Partner: Clue added: Muddy Footprints.",
          "Want to check the shed?"
        ],
        clue: "Muddy Footprints",
        choices: [
          { text: "Check the shed", nextScene: "shed" },
          { text: "Return to mansion entrance", nextScene: "mansionArrival" }
        ]
      },
      shed: {
        background: 'url("https://ph.pinterest.com/pin/610800768251056674/")',
        dialogues: [
          "Inside the shed you find a broken watch with initials 'M.V.'",
          "Partner: Clue added: Broken Watch.",
          "Could this be Ms. Violet's? What next?"
        ],
        clue: "Broken Watch",
        choices: [
          { text: "Interrogate Ms. Violet", nextScene: "interrogateViolet" },
          { text: "Return to mansion entrance", nextScene: "mansionArrival" }
        ]
      },
      interrogateMustard: {
        background: '#3a3a3a',
        dialogues: [
          "Colonel Mustard: I was just checking some books, didn't kill anyone!",
          "Partner: Seems nervous. Let's see if we can press him."
        ],
        choices: [
          { text: "Press Colonel Mustard", nextScene: "pressMustard" },
          { text: "Return to mansion entrance", nextScene: "mansionArrival" }
        ]
      },
      pressMustard: {
        background: '#3a3a3a',
        dialogues: [
          "Colonel Mustard: Fine! I admit, I argued with the victim about a rare book!",
          "Partner: Clue added: Mustard Argument.",
          "What's next?"
        ],
        clue: "Mustard Argument",
        choices: [
          { text: "Accuse a suspect", nextScene: "accuse" },
          { text: "Return to mansion entrance", nextScene: "mansionArrival" }
        ]
      },
      interrogatePeacock: {
        background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=800&q=80")',
        dialogues: [
          "Mrs. Peacock: I was in the kitchen all night. You can ask the butler.",
          "Partner: Clue added: Peacock's Alibi.",
          "Want to press her?"
        ],
        clue: "Peacock's Alibi",
        choices: [
          { text: "Press Mrs. Peacock", nextScene: "pressPeacock" },
          { text: "Return to mansion entrance", nextScene: "mansionArrival" }
        ]
      },
      pressPeacock: {
        background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=800&q=80")',
        dialogues: [
          "Mrs. Peacock: I swear I know nothing! Please stop bothering me!",
          "Partner: Not much more from her.",
          "Where to next?"
        ],
        choices: [
          { text: "Accuse a suspect", nextScene: "accuse" },
          { text: "Return to mansion entrance", nextScene: "mansionArrival" }
        ]
      },
      interrogateViolet: {
        background: '#4a2c3b',
        dialogues: [
          "Ms. Violet: The victim was going to cut me off financially if I didnâ€™t leave town!",
          "Partner: Clue added: Violet threatened.",
          "Press her or go back?"
        ],
        clue: "Violet threatened",
        choices: [
          { text: "Press Violet", nextScene: "pressViolet" },
          { text: "Return to mansion entrance", nextScene: "mansionArrival" }
        ]
      },
      pressViolet: {
        background: '#4a2c3b',
        dialogues: [
          "Ms. Violet: Okay! I admit it! But I didn't kill him!",
          "Partner: You have to decide who to accuse."
        ],
        choices: [
          { text: "Accuse a suspect", nextScene: "accuse" },
          { text: "Return to mansion entrance", nextScene: "mansionArrival" }
        ]
      },
      accuse: {
        background: '#111',
        dialogues: [
          "Partner: Based on what we've gathered, who do you think the culprit is?"
        ],
        choices: [
          { text: "Mr. Green", nextScene: "accuseResult", suspect: "Mr. Green" },
          { text: "Ms. Violet", nextScene: "accuseResult", suspect: "Ms. Violet" },
          { text: "Colonel Mustard", nextScene: "accuseResult", suspect: "Colonel Mustard" },
          { text: "Mrs. Peacock", nextScene: "accuseResult", suspect: "Mrs. Peacock" }
        ]
      },
      accuseResult: {
        background: '#111',
        dialogues: [
                    "Partner: Let's drink tonight!",
                    "You: Nahh I pass, I'd rather sleep",
                    "Partner: At least itâ€”",
                    "Partner: Hey! Wait for me",
                    "You: Faster or the restaurant will be closed"

        
        ],
        choices: [
              { text:"nextCase", nextScene: "comedyIntro"}
        ]
      },
       comedyIntro: {
        background: '#222',
        dialogues: [
          "Partner: Hey, you sound half asleep... Did the last case tire you out?",
          "You: Haha, yeah... that one was a real brain bender.",
          "Partner: Well, get ready! Iâ€™m starting the car.",
          "You: Wait, why do we even have cases again? Canâ€™t we take a day off?",
          "Partner: Ha! You can try running, but where do you think youâ€™ll go?",
          "You: ...Fine, letâ€™s go then."
        ],
        choices: [
          { text: "Start New Case", nextScene: "newCaseIntro" }
        ]
      },
    
      newCaseIntro: {
        background: 'url("https://i.pinimg.com/1200x/88/ab/e7/88abe7bc304cda26263f72ef46186c1a.jpg")',
        dialogues: [
          "You arrive at the new crime scene â€” a bustling city alley with a twist.",
          "Partner: This oneâ€™s going to be tricky. Are you ready?"
        ],
        choices: [
          { text: "Start Investigation", nextScene: "alleyScene2" }
        ]
      },
    
      alleyScene2: {
        background: 'url("https://i.pinimg.com/1200x/88/ab/e7/88abe7bc304cda26263f72ef46186c1a.jpg")',
        dialogues: [
          "You look around the alley. Trash cans overturned, mysterious footprints.",
          "Partner: Looks like someone was in a hurry. What do you want to do?"
        ],
        choices: [
          { text: "Inspect footprints", nextScene: "footprints2" },
          { text: "Check the trash cans", nextScene: "trashCans2" },
          { text: "Talk to the nearby witness", nextScene: "witness2" }
        ]
      },
    
      footprints2: {
        background: 'url("https://i.pinimg.com/1200x/8a/e3/e9/8ae3e957ce42f6066cc8a65569abf63a.jpg")',
        dialogues: [
          "The footprints seem fresh, leading towards the back entrance of a nearby building.",
          "Partner: Clue added: Fresh Footprints."
        ],
        clue: "Fresh Footprints",
        choices: [
          { text: "Follow footprints", nextScene: "backEntrance2" },
          { text: "Go back", nextScene: "alleyScene2" }
        ]
      },
    
      trashCans2: {
        background: 'url("https://i.pinimg.com/1200x/2c/4e/f2/2c4ef297b9e88f74b39cbb040a621eb4.jpg")',
        dialogues: [
          "You rummage through the trash cans and find a torn piece of fabric.",
          "Partner: Clue added: Torn Fabric."
        ],
        clue: "Torn Fabric",
        choices: [
          { text: "Take fabric to analyze later", nextScene: "alleyScene2" }
        ]
      },
    
      witness2: {
        background: 'url("https://i.pinimg.com/1200x/25/15/44/25154472ef6d3ae6efd7f61489dca5f9.jpg")',
        dialogues: [
          "The witness nervously mentions seeing a shadowy figure running away.",
          "Partner: Clue added: Shadowy Figure Witnessed."
        ],
        clue: "Shadowy Figure Witnessed",
        choices: [
          { text: "Ask more questions", nextScene: "witnessQuestions2" },
          { text: "Return to alley", nextScene: "alleyScene2" }
        ]
      },
    
      witnessQuestions2: {
        background: 'url("https://i.pinimg.com/1200x/25/15/44/25154472ef6d3ae6efd7f61489dca5f9.jpg")',
        dialogues: [
          "Witness: They were wearing a hoodie and moved really fast.",
          "Partner: Could be important. We need to find out who it was."
        ],
        choices: [
          { text: "Go check the back entrance", nextScene: "backEntrance2" },
          { text: "Return to alley", nextScene: "alleyScene2" }
        ]
      },
    
      backEntrance2: {
        background: 'url("https://i.pinimg.com/1200x/ca/36/f5/ca36f5d62e03bf97acb1d84be3b53488.jpg")',
        dialogues: [
          "You arrive at the back entrance. The door is slightly ajar.",
          "Partner: Should we go in?"
        ],
        choices: [
          { text: "Enter the building", nextScene: "insideBuilding2" },
          { text: "Go back", nextScene: "alleyScene2" }
        ]
      },
    
      insideBuilding2: {
        background: 'url("https://i.pinimg.com/1200x/ca/36/f5/ca36f5d62e03bf97acb1d84be3b53488.jpg")',
        dialogues: [
          "Inside, you see overturned furniture and a broken vase.",
          "Partner: Looks like a struggle happened here. Clue added: Signs of Struggle."
        ],
        clue: "Signs of Struggle",
        choices: [
          { text: "Search the room", nextScene: "searchRoom2" },
          { text: "Return outside", nextScene: "backEntrance2" }
        ]
      },
    
      searchRoom2: {
        background: 'url("https://i.pinimg.com/1200x/ca/36/f5/ca36f5d62e03bf97acb1d84be3b53488.jpg")',
        dialogues: [
          "You find a hidden note under the table with a strange symbol.",
          "Partner: Clue added: Strange Symbol Note."
        ],
        clue: "Strange Symbol Note",
        choices: [
          { text: "Take note for analysis", nextScene: "insideBuilding2" },
          { text: "Return outside", nextScene: "backEntrance2" },
          { text: "Let's Analyze", nextScene: "analyzeClues2" }
        ]
      },
    
      analyzeClues2: {
        background: '#111',
        dialogues: [
          "You spread out your clues and start piecing things together.",
          "Partner: We have: Torn Fabric, Fresh Footprints, Shadowy Figure Witnessed, Signs of Struggle, and Strange Symbol Note.",
          "You: Something tells me these are connected."
        ],
        choices: [
          { text: "Go back to the alley", nextScene: "alleyScene2" },
          { text: "Visit the lab to analyze fabric", nextScene: "labScene2" },
          { text: "Head to local informant", nextScene: "informantScene2" }
        ]
      },
    
      labScene2: {
        background: 'url("https://images.unsplash.com/photo-1554475901-4538ddfbccc2?auto=format&fit=crop&w=870&q=80")',
        dialogues: [
          "At the lab, technicians examine the torn fabric under the microscope.",
          "Technician: This fabric matches a rare brand only sold in one store downtown."
        ],
        clue: "Rare Brand Fabric",
        choices: [
          { text: "Go visit the store", nextScene: "storeScene2" },
          { text: "Return to analysis", nextScene: "analyzeClues2" }
        ]
      },
    
      storeScene2: {
        background: 'url("https://images.unsplash.com/photo-1508898578281-774ac4893a83?auto=format&fit=crop&w=870&q=80")',
        dialogues: [
          "The store owner recognizes the fabric and mentions a recent suspicious customer.",
          "Store Owner: He was wearing a hoodie, came in looking nervous."
        ],
        clue: "Hoodie Suspicious Customer",
        choices: [
          { text: "Ask about the customer's name", nextScene: "storeOwnerQuestions2" },
          { text: "Return to analysis", nextScene: "analyzeClues2" }
        ]
      },
    
      storeOwnerQuestions2: {
        background: 'url("https://images.unsplash.com/photo-1508898578281-774ac4893a83?auto=format&fit=crop&w=870&q=80")',
        dialogues: [
          "Store Owner: Sorry, I didnâ€™t catch his name, but he paid in cash and left fast.",
          "Partner: Not much to go on. Let's keep digging."
        ],
        choices: [
          { text: "Return to analysis", nextScene: "analyzeClues2" }
        ]
      },
      
        informantScene2: {
          background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=870&q=80")',
          dialogues: [
            "Your informant greets you in a dimly lit bar.",
            "Informant: I heard whispers about a gang using strange symbols to mark territory.",
            "Partner: Could that be related to the strange symbol note?"
          ],
          clue: "Gang Symbol Connection",
          choices: [
            { text: "Ask about gang members", nextScene: "gangInfo2" },
            { text: "Return to analysis", nextScene: "analyzeClues2" }
          ]
        },
      
        gangInfo2: {
          background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=870&q=80")',
          dialogues: [
            "Informant: The gangâ€™s leader is called 'The Hooded One'.",
            "Partner: Fits the hoodie clue. This is getting interesting."
          ],
          choices: [
            { text: "Look for 'The Hooded One'", nextScene: "hoodedOneScene2" },
            { text: "Return to analysis", nextScene: "analyzeClues2" }
          ]
        },
      
        hoodedOneScene2: {
          background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=870&q=80")',
          dialogues: [
            "You track down a suspicious figure matching the description near the docks.",
            "Partner: There he is... The Hooded One."
          ],
          choices: [
            { text: "Confront him", nextScene: "confrontation2" },
            { text: "Observe quietly", nextScene: "observe2" }
          ]
        },
      
        confrontation2: {
          background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=870&q=80")',
          dialogues: [
            "You confront the hooded figure. He pulls down his hood revealing... itâ€™s the store owner!",
            "Partner: What?! That canâ€™t be right."
          ],
          choices: [
            { text: "Accuse store owner", nextScene: "accuseStoreOwner2" },
            { text: "Keep investigating", nextScene: "analyzeClues2" }
          ]
        },
      
        accuseStoreOwner2: {
          background: '#800000',
          dialogues: [
            "You accuse the store owner of being involved in the crime.",
            "Store Owner: I swear I didnâ€™t do anything! Itâ€™s not what it looks like!",
            "Partner: We need more proof."
          ],
          choices: [
            { text: "Return to analysis", nextScene: "analyzeClues2" }
          ]
        },
      
        observe2: {
          background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=870&q=80")',
          dialogues: [
            "You observe quietly and notice the hooded figure slipping something into a locker.",
            "Partner: Letâ€™s check that locker."
          ],
          choices: [
            { text: "Open locker", nextScene: "lockerScene2" },
            { text: "Follow figure further", nextScene: "followFigure2" }
          ]
        },
      
        lockerScene2: {
          background: 'url("https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=870&q=80")',
          dialogues: [
            "Inside the locker, you find stolen goods and evidence linking the store owner to the crime.",
            "Partner: This is the proof we need!"
          ],
          clue: "Locker Evidence",
          choices: [
            { text: "Arrest store owner", nextScene: "caseSolved2" },
            { text: "Keep investigating", nextScene: "analyzeClues2" }
          ]
        },
      
        followFigure2: {
          background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=870&q=80")',
          dialogues: [
            "You follow the hooded figure to an abandoned warehouse.",
            "Partner: Looks like the gang's hideout."
          ],
          choices: [
            { text: "Enter warehouse", nextScene: "warehouseScene2" },
            { text: "Call for backup", nextScene: "callBackup2" }
          ]
        },
      
        warehouseScene2: {
          background: 'url("https://images.unsplash.com/photo-1518837695005-2083093ee35b?auto=format&fit=crop&w=870&q=80")',
          dialogues: [
            "Inside the warehouse, you find gang members counting stolen goods.",
            "Partner: We caught them red-handed!"
          ],
          choices: [
            { text: "Arrest gang members", nextScene: "caseSolved2" },
            { text: "Try to gather more evidence", nextScene: "gatherEvidence2" }
          ]
        },
      
        callBackup2: {
          background: '#333',
          dialogues: [
            "You call for backup. Police reinforcements arrive quickly.",
            "Partner: Time to make the arrests!"
          ],
          choices: [
            { text: "Arrest gang members", nextScene: "caseSolved2" }
          ]
        },
      
        gatherEvidence2: {
          background: '#222',
          dialogues: [
            "You find a ledger listing all stolen items and gang members.",
            "Partner: This will make the case airtight."
          ],
          clue: "Gang Ledger",
          choices: [
            { text: "Take ledger and arrest", nextScene: "caseSolved2" }
          ]
        },
      
        caseSolved2: {
          background: '#004400',
          dialogues: [
            "The case is closed! The gang is behind bars and the mystery solved.",
            "Partner: Nice work, detective. Ready for the next case?"
          ],
          choices: [
            { text: "nextCase", nextScene: "Intro3" }
          ]
        },
  
        intro3: {
      background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Mr. Detective: Another body, same pattern.",
        "Partner: What is this, Tuesday?",
        "Suddenly, a shopping cart flies down the hill, crashing into Mr. Detective.",
        "Emma: Oh! Sorry! I was running from angry geese!",
        "Partner: Well, that's one way to meet a lady.",
        "Mr. Detective: Are you hurt?",
        "Emma: Just my pride and maybe my butt."
      ],
      choices: [
        { text: "Help Emma up", nextScene: "meetEmma" },
        { text: "Ignore her and continue investigation", nextScene: "continueInvestigation" }
      ]
    },
  
    meetEmma: {
      background: 'url("https://images.unsplash.com/photo-1494526585095-c41746248156?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Emma: Thanks. I think Iâ€™m being followed by some dangerous people.",
        "Mr. Detective: Dangerous how?",
        "Emma: They want a painting my grandfather hid years ago.",
        "Partner: Sounds like weâ€™re in the middle of something big.",
        "Mr. Detective: Letâ€™s check out her story."
      ],
      choices: [
        { text: "Trust Emma and investigate together", nextScene: "investigateTogether" },
        { text: "Keep her out of it and work alone", nextScene: "workAlone" }
      ]
    },
  
    continueInvestigation: {
      background: 'url("https://images.unsplash.com/photo-1496307042754-b4aa456c4a2d?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Mr. Detective ignores Emma and moves on.",
        "Partner: You sure about that? She might know something.",
        "A hooded figure watches from afar."
      ],
      choices: [
        { text: "Follow the hooded figure", nextScene: "followFigure" },
        { text: "Return to Emma and help her", nextScene: "meetEmma" }
      ]
    },
  
    investigateTogether: {
      background: 'url("https://images.unsplash.com/photo-1518837695005-2083093ee35b?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Emma: This way. The gang's hideout is near the old warehouse.",
        "Partner: Ready for some action?",
        "Mr. Detective: Always."
      ],
      choices: [
        { text: "Enter warehouse quietly", nextScene: "warehouseScene" },
        { text: "Call for backup", nextScene: "callBackup" }
      ]
    },
  
    workAlone: {
      background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Mr. Detective: Better keep her safe, but at a distance.",
        "Partner: You sure this wonâ€™t backfire?",
        "Mr. Detective: Trust me, Iâ€™ve handled worse."
      ],
      choices: [
        { text: "Investigate crime scene", nextScene: "crimeScene" },
        { text: "Stakeout nearby", nextScene: "stakeout" }
      ]
    },
  
    warehouseScene: {
      background: 'url("https://images.unsplash.com/photo-1496307042754-b4aa456c4a2d?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Inside the warehouse, gang members count stolen goods.",
        "Partner: We caught them red-handed!",
        "Emma: That painting has to be here somewhere.",
        "Mr. Detective: Search every corner."
      ],
      choices: [
        { text: "Arrest gang members", nextScene: "caseSolved" },
        { text: "Try to gather more evidence", nextScene: "gatherEvidence" }
      ]
    },
  
    callBackup: {
      background: 'url("https://images.unsplash.com/photo-1533777324565-a04e00b9a2b1?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Backup arrives just in time.",
        "Captain: Whatâ€™s the plan?",
        "Mr. Detective: Quick sweep, no mistakes.",
        "Emma watches nervously."
      ],
      choices: [
        { text: "Lead the sweep", nextScene: "warehouseScene" },
        { text: "Stay back and protect Emma", nextScene: "protectEmma" }
      ]
    },
  
    gatherEvidence: {
      background: 'url("https://images.unsplash.com/photo-1494526585095-c41746248156?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Mr. Detective finds a hidden safe behind a painting.",
        "Partner: Jackpot.",
        "Emma: That must be what theyâ€™re after.",
        "Mr. Detective: Letâ€™s crack it open."
      ],
      choices: [
        { text: "Open the safe", nextScene: "openSafe" },
        { text: "Call for backup first", nextScene: "callBackup" }
      ]
    },
  
    openSafe: {
      background: 'url("https://images.unsplash.com/photo-1524233501253-f127d9f84ae9?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Inside the safe is an old map and a mysterious key.",
        "Emma: This is it! My grandfatherâ€™s secret.",
        "Mr. Detective: We need to find what this opens."
      ],
      choices: [
        { text: "Follow the map", nextScene: "followMap" },
        { text: "Hold off and analyze the key", nextScene: "analyzeKey" }
      ]
    },
  
    followFigure: {
      background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "You follow the hooded figure to an abandoned warehouse.",
        "Partner: Looks like the gang's hideout."
      ],
      choices: [
        { text: "Enter warehouse", nextScene: "warehouseScene" },
        { text: "Call for backup", nextScene: "callBackup" }
      ]
    },
  
    protectEmma: {
      background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Mr. Detective stays close to Emma, watching the shadows.",
        "Emma: Iâ€™m glad youâ€™re here.",
        "Mr. Detective: Donâ€™t get used to it."
      ],
      choices: [
        { text: "Comfort Emma", nextScene: "romanticMoment" },
        { text: "Focus on the mission", nextScene: "warehouseScene" }
      ]
    },
  
    romanticMoment: {
      background: 'url("https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Emma: You know, youâ€™re not as grumpy as you look.",
        "Mr. Detective: Maybe Iâ€™m just allergic to geese.",
        "Partner: Thatâ€™s a first.",
        "They all laugh."
      ],
      choices: [
        { text: "Share a smile", nextScene: "warehouseScene" },
        { text: "Get back to work", nextScene: "warehouseScene" }
      ]
    },
  
    caseSolved: {
      background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "The gang is arrested, the painting recovered.",
        "Emma: Thank you for saving me and my grandfatherâ€™s legacy.",
        "Mr. Detective: Just doing my job.",
        "Partner: And maybe finding love in the chaos."
      ],
      choices: [
        { text: "Celebrate victory", nextScene: "ending" }
      ]
    },
  
    ending: {
      background: 'url("https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Mr. Detective and Emma walk off into the sunset.",
        "Partner: So, whenâ€™s the wedding?",
        "Mr. Detective: Letâ€™s solve one more case first."
      ],
      choices: [ { text: "Crime Scene", nextScene: "crimeScene2" }]
    },
  
    // Added new scenes for more length and complexity:
  
    crimeScene2: {
      background: 'url("https://images.unsplash.com/photo-1532467291154-d97b86f9e0f1?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Mr. Detective inspects the latest crime scene.",
        "Partner: No signs of forced entry.",
        "Emma (on phone): I think someoneâ€™s watching me.",
        "Mr. Detective: Stay close."
      ],
      choices: [
        { text: "Look for hidden clues", nextScene: "hiddenClues" },
        { text: "Interview nearby witnesses", nextScene: "interviewWitnesses" }
      ]
    },
  
    stakeout: {
      background: 'url("https://images.unsplash.com/photo-1526378729301-9e4f6f6f5e3a?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Partner: This stakeout is boring.",
        "Mr. Detective: Patience is a virtue.",
        "Emma arrives with coffee and a smile.",
        "Emma: Thought you could use a break."
      ],
      choices: [
        { text: "Accept coffee and chat", nextScene: "coffeeChat" },
        { text: "Stay focused on stakeout", nextScene: "stakeoutContinued" }
      ]
    },
  
    hiddenClues: {
      background: 'url("https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Mr. Detective finds a small symbol carved under a table.",
        "Partner: Looks like a gang tattoo.",
        "Emma: That matches what I saw on their leader."
      ],
      choices: [
        { text: "Research the symbol", nextScene: "researchSymbol" },
        { text: "Keep it for evidence", nextScene: "gatherEvidence" }
      ]
    },
  
    interviewWitnesses: {
      background: 'url("https://images.unsplash.com/photo-1494526585095-c41746248156?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "A nervous man claims he saw someone lurking at night.",
        "Partner: Could be our hooded figure.",
        "Mr. Detective: Thanks. Stay safe."
      ],
      choices: [
        { text: "Follow the lead", nextScene: "followFigure" },
        { text: "Check security cameras", nextScene: "checkCameras" }
      ]
    },
  
    coffeeChat: {
      background: 'url("https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Emma: You know, this detective life isnâ€™t so bad with company.",
        "Mr. Detective: Donâ€™t get used to it.",
        "Partner: Sheâ€™s got you wrapped around her finger."
      ],
      choices: [
        { text: "Tease Mr. Detective", nextScene: "romanticMoment" },
        { text: "Get back to stakeout", nextScene: "stakeoutContinued" }
      ]
    },
  
    stakeoutContinued: {
      background: 'url("https://images.unsplash.com/photo-1526378729301-9e4f6f6f5e3a?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Hours pass with no sign of trouble.",
        "Partner: Iâ€™m falling asleep here.",
        "Suddenly, a shadow moves in the distance."
      ],
      choices: [
        { text: "Investigate the shadow", nextScene: "followFigure" },
        { text: "Call for backup", nextScene: "callBackup" }
      ]
    },
  
    researchSymbol: {
      background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Mr. Detective finds the symbol linked to a secret auction house.",
        "Emma: That explains the stolen art.",
        "Partner: Time to crash their party."
      ],
      choices: [
        { text: "Plan to infiltrate auction", nextScene: "auctionInfiltration" },
        { text: "Gather more evidence first", nextScene: "gatherEvidence" }
      ]
    },
  
    checkCameras: {
      background: 'url("https://images.unsplash.com/photo-1518837695005-2083093ee35b?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Security footage shows the hooded figure sneaking around at night.",
        "Partner: Thereâ€™s our suspect.",
        "Mr. Detective: Letâ€™s tail him."
      ],
      choices: [
        { text: "Follow hooded figure", nextScene: "followFigure" },
        { text: "Set a trap", nextScene: "setTrap" }
      ]
    },
  
    auctionInfiltration: {
      background: 'url("https://images.unsplash.com/photo-1524233501253-f127d9f84ae9?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "At the auction, wealthy criminals bid on stolen art.",
        "Emma: We need proof to bring them down.",
        "Partner: Ready to make a scene?",
        "Mr. Detective: Always."
      ],
      choices: [
        { text: "Cause distraction", nextScene: "causeDistraction" },
        { text: "Secretly gather evidence", nextScene: "gatherEvidence" }
      ]
    },
  
    setTrap: {
      background: 'url("https://images.unsplash.com/photo-1533777324565-a04e00b9a2b1?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Mr. Detective sets a clever trap to catch the hooded figure.",
        "Partner: I hope this works.",
        "Emma: Fingers crossed."
      ],
      choices: [
        { text: "Wait and watch", nextScene: "trapTriggered" },
        { text: "Abandon trap and follow figure", nextScene: "followFigure" }
      ]
    },
  
    causeDistraction: {
      background: 'url("https://images.unsplash.com/photo-1496307042754-b4aa456c4a2d?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Partner knocks over a sculpture, causing chaos.",
        "Guests scream and scatter.",
        "Mr. Detective and Emma grab evidence."
      ],
      choices: [
        { text: "Escape with evidence", nextScene: "escapeAuction" },
        { text: "Fight gang members", nextScene: "fightScene" }
      ]
    },
  
    escapeAuction: {
      background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "They slip out unnoticed with crucial evidence.",
        "Emma: That was close!",
        "Mr. Detective: Weâ€™re one step closer."
      ],
      choices: [
        { text: "Head to police station", nextScene: "caseSolved" },
        { text: "Lay low and plan next move", nextScene: "stakeout" }
      ]
    },
  
    fightScene: {
      background: 'url("https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "A wild fight breaks out.",
        "Partner: Take this!",
        "Mr. Detective: Youâ€™re not getting away with this!"
      ],
      choices: [
        { text: "Win the fight", nextScene: "caseSolved" },
        { text: "Get knocked out", nextScene: "captured" }
      ]
    },
  
    captured: {
      background: 'url("https://images.unsplash.com/photo-1533777324565-a04e00b9a2b1?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Mr. Detective is captured but not for long.",
        "Emma and Partner arrive to rescue him.",
        "Emma: Weâ€™re not letting you get away!"
      ],
      choices: [
        { text: "Break free", nextScene: "caseSolved" }
      ]
    },
  
    trapTriggered: {
      background: 'url("https://images.unsplash.com/photo-1494526585095-c41746248156?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "The hooded figure falls right into the trap.",
        "Partner: Gotcha!",
        "Mr. Detective: Time for some answers."
      ],
      choices: [
        { text: "Interrogate suspect", nextScene: "caseSolved" }
      ]
    },
  
    analyzeKey: {
      background: 'url("https://images.unsplash.com/photo-1524233501253-f127d9f84ae9?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Partner: The key looks ancient.",
        "Mr. Detective: It matches the symbol on the map.",
        "Emma: Then letâ€™s find the lock."
      ],
      choices: [
        { text: "Follow the map", nextScene: "followMap" },
        { text: "Ask local experts", nextScene: "localExperts" }
      ]
    },
  
    followMap: {
      background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "The map leads them to an old mansion on the outskirts of town.",
        "Partner: Creepy place.",
        "Emma: Perfect for hiding secrets."
      ],
      choices: [
        { text: "Enter mansion", nextScene: "mansionExplore" },
        { text: "Scout around first", nextScene: "mansionScout" }
      ]
    },
  
    localExperts: {
      background: 'url("https://images.unsplash.com/photo-1494526585095-c41746248156?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "A historian confirms the key belongs to a secret vault.",
        "Partner: So, vault it is.",
        "Mr. Detective: Letâ€™s get cracking."
      ],
      choices: [
        { text: "Head to vault location", nextScene: "followMap" }
      ]
    },
  
    mansionExplore: {
      background: 'url("https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Inside the mansion, hidden passages and traps abound.",
        "Partner: Watch your step.",
        "Emma: This feels like a movie."
      ],
      choices: [
        { text: "Explore basement", nextScene: "basement" },
        { text: "Check upstairs", nextScene: "upstairs" }
      ]
    },
  
    mansionScout: {
      background: 'url("https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "They find guards outside and decide to wait for nightfall.",
        "Partner: Stealth mode: ON.",
        "Mr. Detective: Letâ€™s do this quietly."
      ],
      choices: [
        { text: "Sneak in at night", nextScene: "mansionExplore" },
        { text: "Call backup", nextScene: "callBackup" }
      ]
    },
  
    basement: {
      background: 'url("https://images.unsplash.com/photo-1533777324565-a04e00b9a2b1?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "In the basement, they discover the vault door.",
        "Emma: This must be it!",
        "Mr. Detective: Time to open it."
      ],
      choices: [
        { text: "Use the key", nextScene: "vaultOpen" },
        { text: "Look for traps", nextScene: "trapCheck" }
      ]
    },
  
    upstairs: {
      background: 'url("https://images.unsplash.com/photo-1496307042754-b4aa456c4a2d?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Upstairs, they find old letters and photographs.",
        "Partner: These might help.",
        "Emma: Family secrets."
      ],
      choices: [
        { text: "Read letters", nextScene: "readLetters" },
        { text: "Go to basement", nextScene: "basement" }
      ]
    },
  
    vaultOpen: {
      background: 'url("https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "The vault opens, revealing priceless art and documents.",
        "Emma: Itâ€™s all here!",
        "Partner: Mission accomplished."
      ],
      choices: [
        { text: "Secure the vault", nextScene: "caseSolved" }
      ]
    },
  
    trapCheck: {
      background: 'url("https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Mr. Detective disarms several traps.",
        "Partner: Good thing you took that course.",
        "Emma: Letâ€™s open the vault now."
      ],
      choices: [
        { text: "Use the key", nextScene: "vaultOpen" }
      ]
    },
  
    readLetters: {
      background: 'url("https://images.unsplash.com/photo-1494526585095-c41746248156?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "The letters reveal a family feud over the painting.",
        "Emma: No wonder people want it.",
        "Mr. Detective: Letâ€™s keep moving."
      ],
      choices: [
        { text: "Go to basement", nextScene: "basement" }
      ]
    },
          secretPassage: {
      background: 'url("https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Mr. Detective finds a hidden lever behind a bookshelf.",
        "Partner: Secret passage? Just like the movies!",
        "Emma: Should we risk it?"
      ],
      choices: [
        { text: "Pull the lever", nextScene: "secretRoom" },
        { text: "Ignore it and search elsewhere", nextScene: "basement" }
      ]
    },
  
    secretRoom: {
      background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "The wall slides open revealing a dimly lit room full of artifacts.",
        "Partner: Jackpot!",
        "Emma: This explains the missing pieces.",
        "Mr. Detective: Letâ€™s gather everything."
      ],
      choices: [
        { text: "Collect artifacts", nextScene: "trapTriggered" },
        { text: "Look for more clues", nextScene: "secretRoomClues" }
      ]
    },
  
    secretRoomClues: {
      background: 'url("https://images.unsplash.com/photo-1494526585095-c41746248156?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "You find an old diary detailing the gangâ€™s plans.",
        "Partner: This could be the key to everything.",
        "Emma: We should bring this to the cops."
      ],
      choices: [
        { text: "Take diary and exit", nextScene: "caseSolved" },
        { text: "Keep exploring", nextScene: "trapTriggered" }
      ]
    },
  
    mysteriousCaller: {
      background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Mr. Detective's phone rings late at night.",
        "Caller: If you want to save her, stop digging.",
        "Partner: That sounded serious.",
        "Emma: Who could it be?"
      ],
      choices: [
        { text: "Ignore the threat", nextScene: "caseSolved" },
        { text: "Investigate the caller", nextScene: "traceCaller" }
      ]
    },
  
    traceCaller: {
      background: 'url("https://images.unsplash.com/photo-1494526585095-c41746248156?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Partner hacks into the call logs.",
        "Partner: Got a location. Looks like an abandoned factory.",
        "Mr. Detective: Letâ€™s check it out before itâ€™s too late."
      ],
      choices: [
        { text: "Go to factory", nextScene: "factoryScene" },
        { text: "Call backup first", nextScene: "callBackup" }
      ]
    },
  
    factoryScene: {
      background: 'url("https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "The factory is dark and silent, with eerie echoes.",
        "Partner: Something feels off.",
        "Emma: I hope weâ€™re not too late."
      ],
      choices: [
        { text: "Search inside", nextScene: "factorySearch" },
        { text: "Wait outside and observe", nextScene: "factoryStakeout" }
      ]
    },
  
    factorySearch: {
      background: 'url("https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "You find Emma tied up in a back room.",
        "Mr. Detective: Donâ€™t worry, we got you.",
        "Partner: Letâ€™s get out of here fast."
      ],
      choices: [
        { text: "Escape quietly", nextScene: "escapeFactory" },
        { text: "Fight your way out", nextScene: "fightScene" }
      ]
    },
  
    factoryStakeout: {
      background: 'url("https://images.unsplash.com/photo-1494526585095-c41746248156?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "You spot suspicious figures entering the factory.",
        "Partner: Time to move in.",
        "Mr. Detective: Letâ€™s go!"
      ],
      choices: [
        { text: "Enter stealthily", nextScene: "factorySearch" },
        { text: "Call backup", nextScene: "callBackup" }
      ]
    },
  
    escapeFactory: {
      background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "You escape the factory just as sirens approach.",
        "Emma: That was too close!",
        "Partner: Next time, no solo rescues."
      ],
      choices: [
        { text: "Head to safe house", nextScene: "safeHouse" }
      ]
    },
  
    safeHouse: {
      background: 'url("https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "At the safe house, Emma thanks you sincerely.",
        "Emma: I owe you my life.",
        "Mr. Detective: Just keep out of trouble next time.",
        "Partner: Yeah, try not to get kidnapped again."
      ],
      choices: [
        { text: "Rest and recover", nextScene: "caseSolved" }
      ]
    },
  
    finalConfrontation: {
      background: 'url("https://images.unsplash.com/photo-1533777324565-a04e00b9a2b1?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "The gang leader challenges you to a final showdown.",
        "Partner: Ready to end this?",
        "Mr. Detective: Letâ€™s finish it."
      ],
      choices: [
        { text: "Fight leader", nextScene: "fightScene" },
        { text: "Try to negotiate", nextScene: "negotiate" }
      ]
    },
  
    negotiate: {
      background: 'url("https://images.unsplash.com/photo-1494526585095-c41746248156?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Mr. Detective tries to talk the leader down.",
        "Leader: Why should I trust you?",
        "Emma: Because we know your secrets."
      ],
      choices: [
        { text: "Offer deal", nextScene: "caseSolved" },
        { text: "Prepare for fight", nextScene: "fightScene" }
      ]
    },
    // Previous scenes...
  
    surpriseVisit: {
      background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Emma shows up unexpectedly at your office.",
        "Emma: I brought coffee... and trouble.",
        "Partner: Trouble follows her like a shadow.",
        "Mr. Detective: Glad youâ€™re here, actually."
      ],
      choices: [
        { text: "Ask about new clues", nextScene: "newClues" },
        { text: "Take a coffee break", nextScene: "coffeeBreak" }
      ]
    },
  
    newClues: {
      background: 'url("https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Emma: I found a strange symbol on the ransom note.",
        "Partner: Looks like a gangâ€™s secret sign.",
        "Mr. Detective: Weâ€™re onto something big."
      ],
      choices: [
        { text: "Investigate symbol", nextScene: "investigateSymbol" },
        { text: "Ignore it", nextScene: "caseSolved" }
      ]
    },
  
    coffeeBreak: {
      background: 'url("https://images.unsplash.com/photo-1494526585095-c41746248156?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "You all relax for a moment.",
        "Partner: We deserve this after all the chaos.",
        "Emma: And maybe a moment to breathe... and flirt.",
        "Mr. Detective: Donâ€™t get any ideas, Partner."
      ],
      choices: [
        { text: "Tease Emma back", nextScene: "flirtScene" },
        { text: "Focus on case", nextScene: "investigateSymbol" }
      ]
    },
  
    flirtScene: {
      background: 'url("https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Emma: So, Detective, do you always solve cases with charm?",
        "Partner: Or just with awkward jokes?",
        "Mr. Detective: Maybe both.",
        "Emma: Keep it coming."
      ],
      choices: [
        { text: "Get serious", nextScene: "investigateSymbol" },
        { text: "Keep flirting", nextScene: "flirtScene2" }
      ]
    },
  
    flirtScene2: {
      background: 'url("https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Partner: If you two keep flirting, Iâ€™m out of a job.",
        "Emma: Heâ€™s jealous!",
        "Mr. Detective: Not jealous, just focused.",
        "Partner: Sure, sure."
      ],
      choices: [
        { text: "Laugh it off and move on", nextScene: "investigateSymbol" }
      ]
    },
  
    investigateSymbol: {
      background: 'url("https://images.unsplash.com/photo-1533777324565-a04e00b9a2b1?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "You trace the symbol to an old secret society.",
        "Partner: Of course itâ€™s a secret society.",
        "Emma: Whatâ€™s next? Secret handshakes?",
        "Mr. Detective: Letâ€™s find out."
      ],
      choices: [
        { text: "Visit societyâ€™s meeting place", nextScene: "secretMeeting" },
        { text: "Look for members nearby", nextScene: "stakeout" }
      ]
    },
  
    secretMeeting: {
      background: 'url("https://images.unsplash.com/photo-1494526585095-c41746248156?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "You sneak into a secret meeting at night.",
        "Partner: Everyone looks serious... and suspicious.",
        "Emma: And a bit creepy.",
        "Mr. Detective: Time to blend in."
      ],
      choices: [
        { text: "Eavesdrop on conversation", nextScene: "eavesdrop" },
        { text: "Confront the leader", nextScene: "finalConfrontation" }
      ]
    },
  
    stakeout: {
      background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "You watch known members meeting in a dark alley.",
        "Partner: Theyâ€™re trading something.",
        "Emma: Looks like the missing artifacts.",
        "Mr. Detective: Letâ€™s catch them red-handed."
      ],
      choices: [
        { text: "Intercept deal", nextScene: "gangRaid" },
        { text: "Follow them quietly", nextScene: "followFigure" }
      ]
    },
  
    gangRaid: {
      background: 'url("https://images.unsplash.com/photo-1533777324565-a04e00b9a2b1?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "A wild fight breaks out.",
        "Partner: Take this!",
        "Mr. Detective: Youâ€™re not getting away with this!"
      ],
      choices: [
        { text: "Win the fight", nextScene: "caseSolved" },
        { text: "Get knocked out", nextScene: "captured" }
      ]
    },

    // Previous scenes...
  
    aftermath: {
      background: 'url("https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "After the raid, you and Partner catch your breath.",
        "Emma: That was intense... but we did it.",
        "Partner: You guys make a good team.",
        "Mr. Detective: Yeah, even if Partner canâ€™t keep up."
      ],
      choices: [
        { text: "Tease Partner", nextScene: "partnerTeased" },
        { text: "Plan next move", nextScene: "planNextMove" }
      ]
    },
  
    partnerTeased: {
      background: 'url("https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Partner: Hey! I was covering your backs!",
        "Emma: Sure, Mr. Clumsy.",
        "Mr. Detective: Donâ€™t worry, Partner. We love you anyway.",
        "Partner: Iâ€™m insulted... but I forgive you."
      ],
      choices: [
        { text: "Laugh it off", nextScene: "planNextMove" }
      ]
    },
  
    planNextMove: {
      background: 'url("https://images.unsplash.com/photo-1494526585095-c41746248156?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Mr. Detective: Weâ€™ve got the gang on the run, but the mastermind is still out there.",
        "Emma: And I have a feeling itâ€™s someone close.",
        "Partner: Time to dig deeper."
      ],
      choices: [
        { text: "Investigate suspects", nextScene: "investigateSuspects" },
        { text: "Stakeout the city", nextScene: "cityStakeout" }
      ]
    },
  
    investigateSuspects: {
      background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "You look into the backgrounds of known criminals and insiders.",
        "Partner: Wait, one name stands out.",
        "Emma: Itâ€™s... the mayor?",
        "Mr. Detective: That explains a lot."
      ],
      choices: [
        { text: "Confront the mayor", nextScene: "mayorConfrontation" },
        { text: "Gather more evidence", nextScene: "gatherEvidence" }
      ]
    },
  
    cityStakeout: {
      background: 'url("https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "You and Partner keep watch over the city streets at night.",
        "Partner: This is boring... any coffee?",
        "Emma: You snooze, you lose.",
        "Mr. Detective: Eyes open, everyone."
      ],
      choices: [
        { text: "Spot suspicious activity", nextScene: "followFigure" },
        { text: "Take a quick break", nextScene: "coffeeBreak" }
      ]
    },
  
    mayorConfrontation: {
      background: 'url("https://images.unsplash.com/photo-1533777324565-a04e00b9a2b1?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "You confront the mayor in his office.",
        "Mayor: You donâ€™t have proof.",
        "Partner: Yet.",
        "Mr. Detective: Weâ€™re coming for you."
      ],
      choices: [
        { text: "Search mayorâ€™s office", nextScene: "searchOffice" },
        { text: "Leave and watch", nextScene: "cityStakeout" }
      ]
    },
  
    gatherEvidence: {
      background: 'url("https://images.unsplash.com/photo-1494526585095-c41746248156?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "You find secret documents linking the mayor to the gang.",
        "Emma: This is big.",
        "Partner: We need to be careful now.",
        "Mr. Detective: Letâ€™s plan the takedown."
      ],
      choices: [
        { text: "Prepare for takedown", nextScene: "finalConfrontation" },
        { text: "Share info with cops", nextScene: "callBackup" }
      ]
    },
  
    searchOffice: {
      background: 'url("https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "You secretly search the mayorâ€™s office.",
        "Partner: Found a hidden safe.",
        "Emma: Let me try to crack it.",
        "Mr. Detective: Hurry, before someone comes."
      ],
      choices: [
        { text: "Open safe", nextScene: "safeContents" },
        { text: "Abort and leave", nextScene: "cityStakeout" }
      ]
    },
  
    safeContents: {
      background: 'url("https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Inside the safe are photos, money, and plans.",
        "Emma: This is the proof we need.",
        "Partner: And blackmail material.",
        "Mr. Detective: Time to end this."
      ],
      choices: [
        { text: "Use evidence to confront mayor", nextScene: "finalConfrontation" }
      ]
    },
         finalConfrontation: {
      background: 'url("https://images.unsplash.com/photo-1533777324565-a04e00b9a2b1?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "You and Partner confront the mayor with the evidence.",
        "Mayor: You think you can ruin me?",
        "Emma: We already have.",
        "Partner: Itâ€™s over, boss."
      ],
      choices: [
        { text: "Arrest the mayor", nextScene: "mayorArrested" },
        { text: "Negotiate surrender", nextScene: "negotiate" }
      ]
    },
  
    negotiate: {
      background: 'url("https://images.unsplash.com/photo-1494526585095-c41746248156?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "Mr. Detective tries to negotiate to avoid violence.",
        "Mayor: Fine, but I want immunity.",
        "Emma: No deals for criminals.",
        "Partner: Yeah, youâ€™re going to jail."
      ],
      choices: [
        { text: "Refuse deal, arrest him", nextScene: "mayorArrested" },
        { text: "Consider deal", nextScene: "caseSolved" }
      ]
    },
  
    mayorArrested: {
      background: 'url("https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "The mayor is handcuffed and led away.",
        "Emma: Justice served!",
        "Partner: And no one got hurt. Well, except his ego.",
        "Mr. Detective: Case closed."
      ],
      choices: [
        { text: "Celebrate at diner", nextScene: "celebration" }
      ]
    },
  
    celebration: {
      background: 'url("https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=870&q=80")',
      dialogues: [
        "You, Partner, and Emma celebrate the victory over burgers and milkshakes.",
        "Emma: To teamwork and coffee!",
        "Partner: And maybe fewer kidnappings.",
        "Mr. Detective: Iâ€™ll drink to that.",
        "Emma: So, Detective, whatâ€™s next for us?",
        "Mr. Detective: Whatever adventure comes our wayâ€”together."
      ],
      choices: [
        { text: "The End", nextScene: null }
      ]
    }
        
    };

    const dialogueElem = document.getElementById('dialogue');
    const choicesElem = document.getElementById('choices');

    let dialogueIndex = 0;

    function setBackground(bg) {
      if (bg.startsWith('url(')) {
        document.body.style.backgroundImage = bg;
        document.body.style.backgroundColor = '';
      } else {
        document.body.style.backgroundImage = '';
        document.body.style.backgroundColor = bg;
      }
    }

    function addClue(clue) {
      if (clue && !gameState.clues.includes(clue)) {
        gameState.clues.push(clue);
      }
    }

    function showScene(sceneKey) {
      const scene = scenes[sceneKey];
      if (!scene) return;

      gameState.currentScene = sceneKey;
      dialogueIndex = 0;
      setBackground(scene.background);

      if (scene.clue) {
        addClue(scene.clue);
      }

      renderDialogue(scene);
      renderChoices(scene);
    }

    function renderDialogue(scene) {
      if (dialogueIndex < scene.dialogues.length) {
        dialogueElem.textContent = scene.dialogues[dialogueIndex];
      } else {
        dialogueElem.textContent = "";
      }
    }

    function renderChoices(scene) {
      choicesElem.innerHTML = "";
      scene.choices.forEach(choice => {
        const btn = document.createElement('button');
        btn.textContent = choice.text;
        btn.onclick = () => {
          if (choice.nextScene === 'accuseResult') {
            gameState.accused = choice.suspect;
            showAccuseResult(choice.suspect);
          } else {
            showScene(choice.nextScene);
          }
        };
        choicesElem.appendChild(btn);
      });
    }

    function showAccuseResult(suspect) {
      dialogueIndex = 0;
      const resultElem = dialogueElem;
      const choicesElemLocal = choicesElem;
      setBackground('#111');

      // Determine if accusation is correct (let's say Colonel Mustard is culprit for example)
      const culprit = 'Colonel Mustard';

      if (suspect === culprit) {
        resultElem.textContent = `You accused ${suspect}. Congratulations! You solved the case! It was indeed ${culprit}.`;
      } else {
        resultElem.textContent = `You accused ${suspect}. Unfortunately, that is incorrect. The real culprit was ${culprit}.`;
      }

      choicesElemLocal.innerHTML = '';

      const restartBtn = document.createElement('button');
      restartBtn.textContent = 'Play Again';
      restartBtn.onclick = () => {
        gameState.clues = [];
        gameState.accused = null;
        showScene('comedyIntro');
      };
      choicesElemLocal.appendChild(restartBtn);
    }

    // Add clicking to advance dialogue in scenes with multiple dialogues
    dialogueElem.addEventListener('click', () => {
      const scene = scenes[gameState.currentScene];
      if (!scene) return;

      if (dialogueIndex < scene.dialogues.length - 1) {
        dialogueIndex++;
        renderDialogue(scene);
      }
    });

    // Start game
    showScene('intro');
  </script>
</body>
</html>
